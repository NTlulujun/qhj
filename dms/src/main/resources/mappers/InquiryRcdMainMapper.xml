<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.project.dms.dao.InquiryRcdMainMapper">
  <resultMap id="BaseResultMap" type="com.project.dms.entiy.InquiryRcdMain">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <id column="INQUIRY_ID" jdbcType="INTEGER" property="inquiryId" />
    <result column="PER_NAME" jdbcType="VARCHAR" property="perName" />
    <result column="PER_ID" jdbcType="VARCHAR" property="perId" />
    <result column="INQUIRY_TIME" jdbcType="VARCHAR" property="inquiryTime" />
    <result column="PER_NAME_IN" jdbcType="VARCHAR" property="perNameIn" />
    <result column="INQUIRY_CONTENT" jdbcType="VARCHAR" property="inquiryContent" />
    <result column="RECORD_CLOSE" jdbcType="VARCHAR" property="recordClose" />
    <result column="USE_FLAG" jdbcType="VARCHAR" property="useFlag" />
  </resultMap>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    delete from inquiry_rcd_main
    where INQUIRY_ID = #{inquiryId,jdbcType=INTEGER}
  </delete>
  <insert id="insert" keyColumn="inquiryId" useGeneratedKeys="true"  keyProperty="inquiryId"  parameterType="com.project.dms.entiy.InquiryRcdMain">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    <selectKey keyProperty="inquiryId" order="AFTER" resultType="java.lang.Integer">
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into inquiry_rcd_main (PER_NAME, PER_ID, INQUIRY_TIME, 
      PER_NAME_IN, INQUIRY_CONTENT, RECORD_CLOSE, 
      USE_FLAG)
    values (#{perName,jdbcType=VARCHAR}, #{perId,jdbcType=VARCHAR}, #{inquiryTime,jdbcType=VARCHAR}, 
      #{perNameIn,jdbcType=VARCHAR}, #{inquiryContent,jdbcType=VARCHAR}, #{recordClose,jdbcType=VARCHAR}, 
      #{useFlag,jdbcType=VARCHAR})
  </insert>
  <update id="updateByPrimaryKey" parameterType="com.project.dms.entiy.InquiryRcdMain">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    update inquiry_rcd_main
    set PER_NAME = #{perName,jdbcType=VARCHAR},
      PER_ID = #{perId,jdbcType=VARCHAR},
      INQUIRY_TIME = #{inquiryTime,jdbcType=VARCHAR},
      PER_NAME_IN = #{perNameIn,jdbcType=VARCHAR},
      INQUIRY_CONTENT = #{inquiryContent,jdbcType=VARCHAR},
      RECORD_CLOSE = #{recordClose,jdbcType=VARCHAR},
      USE_FLAG = #{useFlag,jdbcType=VARCHAR}
    where INQUIRY_ID = #{inquiryId,jdbcType=INTEGER}
  </update>
  <select id="selectByPrimaryKey" parameterType="java.lang.Integer" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select INQUIRY_ID, PER_NAME, PER_ID, INQUIRY_TIME, PER_NAME_IN, INQUIRY_CONTENT, 
    RECORD_CLOSE, USE_FLAG
    from inquiry_rcd_main
    where INQUIRY_ID = #{inquiryId,jdbcType=INTEGER}
  </select>
  <select id="selectAll" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select INQUIRY_ID, PER_NAME, PER_ID, INQUIRY_TIME, PER_NAME_IN, INQUIRY_CONTENT, 
    RECORD_CLOSE, USE_FLAG
    from inquiry_rcd_main
  </select>
  
  <select id="selectByKey" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select a.INQUIRY_ID, a.PER_NAME, a.PER_ID, DATE_FORMAT(a.INQUIRY_TIME,"%Y-%m-%d %T") as INQUIRY_TIME, PER_NAME_IN, INQUIRY_CONTENT, 
    RECORD_CLOSE, a.USE_FLAG
    from inquiry_rcd_main  a 
	LEFT JOIN per_sys_sub b on a.PER_ID=b.PER_ID 
    where b.PER_ID = '${key}' or b.PER_TEL_NUM = '${key}'
    order by DATE_FORMAT(INQUIRY_TIME,"%Y-%m-%d %T") desc 
  </select>
</mapper>